<mat-form-field
  class="c-autocomplete c-input qa-autocomplete"
  [color]="theme"
>

  <ng-container *ngIf="multiple">
    <mat-chip-list #chipList>
      <mat-chip
        *ngFor="let option of selectedOptions"
        [selectable]="selectableChips"
        [removable]="removableChips"
        (remove)="deselectOption(option)"
      >
        {{ displayOption(option) }}
        <mat-icon matChipRemove *ngIf="removableChips">
          cancel
        </mat-icon>
      </mat-chip>

      <input
        matInput
        placeholder="{{ label }}"
        [attr.name]="name"
        [matChipInputFor]="chipList"
        [matAutocomplete]="autocomplete"
        placeholder="{{ label }}"
        [(ngModel)]="searchQuery"
        (ngModelChange)="querySubject.next(searchQuery)"
        #autocompleteTrigger="matAutocompleteTrigger"
        #input
      />
    </mat-chip-list>
  </ng-container>

  <ng-container *ngIf="!multiple">
    <input
      matInput
      placeholder="{{ label }}"
      [attr.name]="name"
      [matAutocomplete]="autocomplete"
      placeholder="{{ label }}"
      [(ngModel)]="searchQuery"
      (ngModelChange)="querySubject.next(searchQuery)"
      #autocompleteTrigger="matAutocompleteTrigger"
      #input
    />
  </ng-container>

  <mat-autocomplete
    #autocomplete="matAutocomplete"
    autoActiveFirstOption="true"
    [displayWith]="displayWith"
    (optionSelected)="selectOption($event, input)"
  >
    <mat-option
      *ngFor="let option of options"
      [value]="option"
    >
      {{ displayOption(option) }}
    </mat-option>
  </mat-autocomplete>

  <mat-hint
    class="qa-autocomplete-hint"
    align="end"
    *ngIf="hint"
  >{{ hint }}</mat-hint>

  <ts-validation-messages
    class="qa-autocomplete-validation-messages"
    *ngIf="resultsControl"
    [control]="resultsControl"
  ></ts-validation-messages>
</mat-form-field>
